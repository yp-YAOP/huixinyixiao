# 慧心康复训练中心 - 本地部署版

基于手势识别的康复训练游戏系统，为患者提供三种不同类型的康复训练，并通过医护工作站实时监控训练数据。

## 🎯 训练项目

### 1. 手眼协调训练（打砖块游戏）
- **文件**: `dazhuankuai.html`
- **训练目标**: 提升手眼协调能力和反应精度
- **操作方式**: 手势控制挡板移动
- **数据类型**: `coordination`

### 2. 反应速度训练（水果忍者）
- **文件**: `shuiguo/index.html`
- **训练目标**: 增强反应速度和动作敏捷性
- **操作方式**: 手势切割水果
- **数据类型**: `reaction`

### 3. 认知能力训练（数字认知）
- **文件**: `renzhi.html`
- **训练目标**: 锻炼认知能力和数字识别
- **操作方式**: 手势显示数字
- **数据类型**: `cognitive`

## 🏥 医护工作站

### 医护端监控
- **文件**: `yihu.html`
- **功能**: 实时监控患者训练数据
- **更新频率**: 每2秒检查新数据
- **数据展示**: 分训练类型显示时长和得分

### 患者选择页
- **文件**: `huanzhe.html`
- **功能**: 患者选择训练项目的入口页面

## 🚀 本地部署

### 方法一：使用启动脚本（推荐）
```bash
# Windows系统
双击 start-local.bat

# 或手动运行
start-local.bat
```

### 方法二：手动启动
```bash
# 进入项目目录
cd huixinyixiao

# 启动Python服务器
python -m http.server 8080

# 或使用Node.js
npx http-server -p 8080
```

### 访问地址
- 🏥 **医护工作站**: http://localhost:8080/yihu.html
- 👥 **患者选择页**: http://localhost:8080/huanzhe.html
- 🎯 **手眼协调训练**: http://localhost:8080/dazhuankuai.html
- ⚡ **反应速度训练**: http://localhost:8080/shuiguo/index.html
- 🧠 **认知能力训练**: http://localhost:8080/renzhi.html

## 📊 数据传输机制

### 本地数据流
1. **游戏端**: 每15秒自动上传训练数据
2. **传输方式**: localStorage本地存储
3. **实时监听**: storage事件触发数据更新
4. **备用机制**: 每2秒定期检查

### 数据格式
```javascript
{
  patientId: 102,              // 患者ID（李阿姨）
  gameType: 'coordination',    // 游戏类型
  scoreIncrease: 5,           // 得分增量
  timeIncrease: 15,           // 时长增量（秒）
  timestamp: "2025-01-28..."  // 时间戳
}
```

### 数据映射
- `coordination` → 手眼协调训练
- `reaction` → 反应速度训练  
- `cognitive` → 认知能力训练

## 🔧 技术架构

### 核心文件
- `gameDataUploader.js` - 统一数据上传工具
- `yihu.html` - 医护工作站主页面
- `game.js` - 打砖块游戏逻辑
- `shuiguo/game.js` - 水果忍者游戏逻辑
- `renzhi.html` - 认知训练游戏（内嵌JS）

### 依赖库
- MediaPipe Hands - 手势识别
- Three.js - 3D图形渲染（水果游戏）
- Chart.js - 数据图表展示
- Tailwind CSS - 界面样式框架

## 📱 使用说明

### 1. 启动系统
```bash
# 运行启动脚本
start-local.bat
```

### 2. 打开医护工作站
- 访问 http://localhost:8080/yihu.html
- 在左侧患者列表中选择"李阿姨"

### 3. 开始训练
- 打开任意训练游戏页面
- 允许摄像头权限
- 将手掌对准摄像头开始训练

### 4. 观察数据
- 游戏中每15秒显示上传通知
- 医护工作站实时更新训练数据
- 右侧通知栏显示数据接收情况

## ⚠️ 注意事项

### 环境要求
- 现代浏览器（支持WebRTC和手势识别）
- 摄像头设备
- 本地服务器环境（不能直接打开HTML文件）

### 权限设置
- 必须允许摄像头访问权限
- 建议在localhost环境下运行
- 确保手势识别正常工作

### 数据持久化
- 患者数据自动保存到localStorage
- 页面刷新后数据不会丢失
- 支持多次游戏会话数据累计

## 🛠️ 故障排除

### 摄像头无法访问
- 检查浏览器权限设置
- 确保使用localhost访问
- 尝试刷新页面重新授权

### 数据未同步
- 检查浏览器控制台是否有错误
- 确认两个页面在同一域名下
- 尝试手动刷新医护工作站页面

### 手势识别不准确
- 调整摄像头角度和距离
- 确保光线充足
- 保持手掌完整可见

## 📄 许可证

本项目遵循项目原有许可证条款。